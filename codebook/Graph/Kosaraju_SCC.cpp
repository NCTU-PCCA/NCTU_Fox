#define MXN 100005
#define PB push_back
#define FZ(s) memset(s,0,sizeof(s))

struct Scc{
int n, nScc, vst[MXN], bln[MXN];
vector<int> E[MXN], rE[MXN], vec;
void init(int _n){
	n = _n;
	for (int i=0; i<MXN; i++){
		E[i].clear();
		rE[i].clear();
	}
}
void add_edge(int u, int v){
	E[u].PB(v);
	rE[v].PB(u);
}
void DFS(int u){
	vst[u]=1;
	for (auto v : E[u])
		if (!vst[v]) DFS(v);
	vec.PB(u);
}
void rDFS(int u){
	vst[u] = 1;
	bln[u] = nScc;
	for (auto v : rE[u])
		if (!vst[v]) rDFS(v);
}
void solve(){
	nScc = 0;
	vec.clear();
	FZ(vst);
	for (int i=0; i<n; i++)
		if (!vst[i]) DFS(i);
	reverse(vec.begin(),vec.end());
	FZ(vst);
	for (auto v : vec){
		if (!vst[v]){
			rDFS(v);
			nScc++;
		}
	}
}
};
